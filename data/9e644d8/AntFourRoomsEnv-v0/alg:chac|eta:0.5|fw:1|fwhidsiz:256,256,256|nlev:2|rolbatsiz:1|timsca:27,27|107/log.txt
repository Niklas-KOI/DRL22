Starting process id: 16437
T: 700
alg: chac
algorithm: baselines.chac
atomic_noise: 0.2
base_logdir: data
batch_size: 1024
bind_core: 0
buffer_size: 500
chac_params: {}
early_stop_data_column: test/success_rate
early_stop_threshold: 0.99
env_name: AntFourRoomsEnv-v0
eta: 0.5
fw: 1
fw_hidden_size: 256,256,256
fw_lr: 0.001
gamma: 0.9985714285714286
graph: 1
info: 
make_env: <function prepare_params.<locals>.make_env at 0x7f9b625210e0>
max_try_idx: 199
mu_hidden_size: 64
mu_lr: 0.001
n_episodes: 0
n_levels: 2
n_pre_episodes: 30
n_test_rollouts: 25
n_train_batches: 40
n_train_rollouts: 0
num_threads: 5
q_hidden_size: 64
q_lr: 0.001
random_action_perc: 0.3
render: 0
rollout_batch_size: 1
subgoal_noise: 0.2
subgoal_test_perc: 0.3
time_scales: 27,27
try_start_idx: 100
use_mpi: False
verbose: False

*** Warning ***
You are running baselines.chac with just a single MPI worker. This will work, but the HER experiments that we report in Plappert et al. (2018, https://arxiv.org/abs/1802.09464) were obtained with --num_cpu 19. This makes a significant difference and if you are looking to reproduce those results, be aware of this. Please also refer to https://github.com/openai/baselines/issues/314 for further details.
****************

dims: action = 8, subgoal = 5, end_goal = 3
subgoal_bounds: symmetric [8.  8.  0.5 3.  3. ], offset [0.  0.  0.5 0.  0. ]
Running on CPU ...
Creating a CHAC agent

Hierarchy Level 0 with time scale 27
Actor(
  (fc1): Linear(in_features=34, out_features=64, bias=True)
  (fc2): Linear(in_features=64, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=64, bias=True)
  (fc4): Linear(in_features=64, out_features=8, bias=True)
)
Critic(
  (fc1): Linear(in_features=42, out_features=64, bias=True)
  (fc2): Linear(in_features=64, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=64, bias=True)
  (fc4): Linear(in_features=64, out_features=1, bias=True)
  (mse_loss): MSELoss()
)
ForwardModel(
  (mlp): Sequential(
    (0): Linear(in_features=37, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=256, bias=True)
    (3): ReLU()
    (4): Linear(in_features=256, out_features=256, bias=True)
    (5): ReLU()
    (6): Linear(in_features=256, out_features=29, bias=True)
    (7): Identity()
  )
  (mse_loss): MSELoss()
)

Hierarchy Level 1 with time scale 27
Actor(
  (fc1): Linear(in_features=32, out_features=64, bias=True)
  (fc2): Linear(in_features=64, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=64, bias=True)
  (fc4): Linear(in_features=64, out_features=5, bias=True)
)
Critic(
  (fc1): Linear(in_features=37, out_features=64, bias=True)
  (fc2): Linear(in_features=64, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=64, bias=True)
  (fc4): Linear(in_features=64, out_features=1, bias=True)
  (mse_loss): MSELoss()
)
ForwardModel(
  (mlp): Sequential(
    (0): Linear(in_features=34, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=256, bias=True)
    (3): ReLU()
    (4): Linear(in_features=256, out_features=256, bias=True)
    (5): ReLU()
    (6): Linear(in_features=256, out_features=29, bias=True)
    (7): Identity()
  )
  (mse_loss): MSELoss()
)
Training epoch 0
Time for epoch 0: 0.00. Rollout time: 0.00, Training time: 0.00
Evaluating epoch 0
Data_dir: data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107
---------------------------------------------------
| epoch                    | 0                    |
| policy/steps             | 18225.0              |
| test/episodes            | 25.0                 |
| test/success_rate        | 0.0                  |
| test_0/avg_q             | -0.06697704990011193 |
| test_1/avg_q             | -0.06689486982525644 |
| test_1/n_subgoals        | 675.0                |
| test_1/subgoal_succ_rate | 0.0                  |
| train/episodes           | 0.0                  |
| train/success_rate       | nan                  |
---------------------------------------------------
Saving periodic policy to data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107/policy_0.pkl ...
New best value for test/success_rate: 0.0. Saving policy to data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107/policy_best.pkl ...
Training epoch 1
Time for epoch 1: 0.00. Rollout time: 0.00, Training time: 0.00
Evaluating epoch 1
Data_dir: data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107
---------------------------------------------------
| epoch                    | 1                    |
| policy/steps             | 36450.0              |
| test/episodes            | 50.0                 |
| test/success_rate        | 0.0                  |
| test_0/avg_q             | -0.06698649231751194 |
| test_1/avg_q             | -0.06689085674713739 |
| test_1/n_subgoals        | 675.0                |
| test_1/subgoal_succ_rate | 0.0                  |
| train/episodes           | 0.0                  |
| train/success_rate       | nan                  |
---------------------------------------------------
New best value for test/success_rate: 0.0. Saving policy to data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107/policy_best.pkl ...
Training epoch 2
Time for epoch 2: 0.00. Rollout time: 0.00, Training time: 0.00
Evaluating epoch 2
Data_dir: data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107
---------------------------------------------------
| epoch                    | 2                    |
| policy/steps             | 54675.0              |
| test/episodes            | 75.0                 |
| test/success_rate        | 0.0                  |
| test_0/avg_q             | -0.06698108352288559 |
| test_1/avg_q             | -0.06688954328607996 |
| test_1/n_subgoals        | 675.0                |
| test_1/subgoal_succ_rate | 0.0                  |
| train/episodes           | 0.0                  |
| train/success_rate       | nan                  |
---------------------------------------------------
New best value for test/success_rate: 0.0. Saving policy to data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107/policy_best.pkl ...
Training epoch 3
Time for epoch 3: 0.00. Rollout time: 0.00, Training time: 0.00
Evaluating epoch 3
Data_dir: data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107
---------------------------------------------------
| epoch                    | 3                    |
| policy/steps             | 72900.0              |
| test/episodes            | 100.0                |
| test/success_rate        | 0.0                  |
| test_0/avg_q             | -0.0669902785047272  |
| test_1/avg_q             | -0.06690084667126715 |
| test_1/n_subgoals        | 675.0                |
| test_1/subgoal_succ_rate | 0.0                  |
| train/episodes           | 0.0                  |
| train/success_rate       | nan                  |
---------------------------------------------------
New best value for test/success_rate: 0.0. Saving policy to data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107/policy_best.pkl ...
Mean of test/success_rate of last 4 epochs: 0.0
Training epoch 4
Time for epoch 4: 0.00. Rollout time: 0.00, Training time: 0.00
Evaluating epoch 4
Data_dir: data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107
---------------------------------------------------
| epoch                    | 4                    |
| policy/steps             | 91125.0              |
| test/episodes            | 125.0                |
| test/success_rate        | 0.0                  |
| test_0/avg_q             | -0.06697288320359397 |
| test_1/avg_q             | -0.06689211339427352 |
| test_1/n_subgoals        | 675.0                |
| test_1/subgoal_succ_rate | 0.0                  |
| train/episodes           | 0.0                  |
| train/success_rate       | nan                  |
---------------------------------------------------
New best value for test/success_rate: 0.0. Saving policy to data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107/policy_best.pkl ...
Mean of test/success_rate of last 4 epochs: 0.0
Training epoch 5
Time for epoch 5: 0.00. Rollout time: 0.00, Training time: 0.00
Evaluating epoch 5
Data_dir: data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107
---------------------------------------------------
| epoch                    | 5                    |
| policy/steps             | 109350.0             |
| test/episodes            | 150.0                |
| test/success_rate        | 0.0                  |
| test_0/avg_q             | -0.06698670156758424 |
| test_1/avg_q             | -0.06689068827239258 |
| test_1/n_subgoals        | 675.0                |
| test_1/subgoal_succ_rate | 0.0                  |
| train/episodes           | 0.0                  |
| train/success_rate       | nan                  |
---------------------------------------------------
New best value for test/success_rate: 0.0. Saving policy to data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107/policy_best.pkl ...
Mean of test/success_rate of last 4 epochs: 0.0
Training epoch 6
Time for epoch 6: 0.00. Rollout time: 0.00, Training time: 0.00
Evaluating epoch 6
Data_dir: data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107
---------------------------------------------------
| epoch                    | 6                    |
| policy/steps             | 127575.0             |
| test/episodes            | 175.0                |
| test/success_rate        | 0.0                  |
| test_0/avg_q             | -0.06697383090321711 |
| test_1/avg_q             | -0.06688004325438296 |
| test_1/n_subgoals        | 675.0                |
| test_1/subgoal_succ_rate | 0.0                  |
| train/episodes           | 0.0                  |
| train/success_rate       | nan                  |
---------------------------------------------------
New best value for test/success_rate: 0.0. Saving policy to data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107/policy_best.pkl ...
Mean of test/success_rate of last 4 epochs: 0.0
Training epoch 7
Time for epoch 7: 0.00. Rollout time: 0.00, Training time: 0.00
Evaluating epoch 7
Data_dir: data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107
---------------------------------------------------
| epoch                    | 7                    |
| policy/steps             | 145800.0             |
| test/episodes            | 200.0                |
| test/success_rate        | 0.0                  |
| test_0/avg_q             | -0.06698933887085966 |
| test_1/avg_q             | -0.06688280137064129 |
| test_1/n_subgoals        | 675.0                |
| test_1/subgoal_succ_rate | 0.0                  |
| train/episodes           | 0.0                  |
| train/success_rate       | nan                  |
---------------------------------------------------
New best value for test/success_rate: 0.0. Saving policy to data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107/policy_best.pkl ...
Mean of test/success_rate of last 4 epochs: 0.0
Training epoch 8
Time for epoch 8: 0.00. Rollout time: 0.00, Training time: 0.00
Evaluating epoch 8
Data_dir: data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107
---------------------------------------------------
| epoch                    | 8                    |
| policy/steps             | 164025.0             |
| test/episodes            | 225.0                |
| test/success_rate        | 0.0                  |
| test_0/avg_q             | -0.06699096957876988 |
| test_1/avg_q             | -0.06690652531682487 |
| test_1/n_subgoals        | 675.0                |
| test_1/subgoal_succ_rate | 0.0                  |
| train/episodes           | 0.0                  |
| train/success_rate       | nan                  |
---------------------------------------------------
New best value for test/success_rate: 0.0. Saving policy to data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107/policy_best.pkl ...
Mean of test/success_rate of last 4 epochs: 0.0
Training epoch 9
Time for epoch 9: 0.00. Rollout time: 0.00, Training time: 0.00
Evaluating epoch 9
Data_dir: data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107
---------------------------------------------------
| epoch                    | 9                    |
| policy/steps             | 182250.0             |
| test/episodes            | 250.0                |
| test/success_rate        | 0.0                  |
| test_0/avg_q             | -0.06698681554677462 |
| test_1/avg_q             | -0.06689995042080746 |
| test_1/n_subgoals        | 675.0                |
| test_1/subgoal_succ_rate | 0.0                  |
| train/episodes           | 0.0                  |
| train/success_rate       | nan                  |
---------------------------------------------------
New best value for test/success_rate: 0.0. Saving policy to data/9e644d8/AntFourRoomsEnv-v0/alg:chac|eta:0.5|fw:1|fwhidsiz:256,256,256|nlev:2|rolbatsiz:1|timsca:27,27|107/policy_best.pkl ...
Mean of test/success_rate of last 4 epochs: 0.0
All epochs are finished. Stopping the training now.
